<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 Test för två stickprov | R-anvisningar till Grundläggande statistik</title>
  <meta name="description" content="5 Test för två stickprov | R-anvisningar till Grundläggande statistik" />
  <meta name="generator" content="bookdown 0.41 and GitBook 2.6.7" />

  <meta property="og:title" content="5 Test för två stickprov | R-anvisningar till Grundläggande statistik" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 Test för två stickprov | R-anvisningar till Grundläggande statistik" />
  
  
  



<meta name="date" content="2024-10-24" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="ett-stickprov-av-icke-normalfördelad-data.html"/>
<link rel="next" href="variansanalys.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R-anvisningar</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduktion</a></li>
<li class="chapter" data-level="" data-path="installation-av-r-och-rstudio.html"><a href="installation-av-r-och-rstudio.html"><i class="fa fa-check"></i>Installation av R och RStudio</a>
<ul>
<li class="chapter" data-level="0.1" data-path="installation-av-r-och-rstudio.html"><a href="installation-av-r-och-rstudio.html#inledning"><i class="fa fa-check"></i><b>0.1</b> Inledning</a></li>
<li class="chapter" data-level="0.2" data-path="installation-av-r-och-rstudio.html"><a href="installation-av-r-och-rstudio.html#installation-av-r"><i class="fa fa-check"></i><b>0.2</b> Installation av R</a></li>
<li class="chapter" data-level="0.3" data-path="installation-av-r-och-rstudio.html"><a href="installation-av-r-och-rstudio.html#installation-av-rstudio"><i class="fa fa-check"></i><b>0.3</b> Installation av RStudio</a></li>
<li class="chapter" data-level="0.4" data-path="installation-av-r-och-rstudio.html"><a href="installation-av-r-och-rstudio.html#gränssnittet-i-rstudio"><i class="fa fa-check"></i><b>0.4</b> Gränssnittet i RStudio</a></li>
<li class="chapter" data-level="0.5" data-path="installation-av-r-och-rstudio.html"><a href="installation-av-r-och-rstudio.html#paket-i-r"><i class="fa fa-check"></i><b>0.5</b> Paket i R</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="datahantering-och-grafer.html"><a href="datahantering-och-grafer.html"><i class="fa fa-check"></i><b>1</b> Datahantering och grafer</a>
<ul>
<li class="chapter" data-level="1.1" data-path="datahantering-och-grafer.html"><a href="datahantering-och-grafer.html#uppstart-och-orientering"><i class="fa fa-check"></i><b>1.1</b> Uppstart och orientering</a></li>
<li class="chapter" data-level="1.2" data-path="datahantering-och-grafer.html"><a href="datahantering-och-grafer.html#packages-från-cran"><i class="fa fa-check"></i><b>1.2</b> <em>Packages</em> från CRAN</a></li>
<li class="chapter" data-level="1.3" data-path="datahantering-och-grafer.html"><a href="datahantering-och-grafer.html#objekt-och-funktioner"><i class="fa fa-check"></i><b>1.3</b> Objekt och funktioner</a></li>
<li class="chapter" data-level="1.4" data-path="datahantering-och-grafer.html"><a href="datahantering-och-grafer.html#sekvenser-av-funktioner"><i class="fa fa-check"></i><b>1.4</b> Sekvenser av funktioner</a></li>
<li class="chapter" data-level="1.5" data-path="datahantering-och-grafer.html"><a href="datahantering-och-grafer.html#datainskrivning"><i class="fa fa-check"></i><b>1.5</b> Datainskrivning</a></li>
<li class="chapter" data-level="1.6" data-path="datahantering-och-grafer.html"><a href="datahantering-och-grafer.html#urval-ur-en-tabell-med-select-och-filter"><i class="fa fa-check"></i><b>1.6</b> Urval ur en tabell med <code>select</code> och <code>filter</code></a></li>
<li class="chapter" data-level="1.7" data-path="datahantering-och-grafer.html"><a href="datahantering-och-grafer.html#grafer-med-ggplot2"><i class="fa fa-check"></i><b>1.7</b> Grafer med <code>ggplot2</code></a></li>
<li class="chapter" data-level="1.8" data-path="datahantering-och-grafer.html"><a href="datahantering-och-grafer.html#ai-uppgift-i"><i class="fa fa-check"></i><b>1.8</b> AI-uppgift I</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="beskrivande-statistik.html"><a href="beskrivande-statistik.html"><i class="fa fa-check"></i><b>2</b> Beskrivande statistik</a>
<ul>
<li class="chapter" data-level="2.1" data-path="beskrivande-statistik.html"><a href="beskrivande-statistik.html#repetition-från-datorövning-1"><i class="fa fa-check"></i><b>2.1</b> Repetition från datorövning 1</a></li>
<li class="chapter" data-level="2.2" data-path="beskrivande-statistik.html"><a href="beskrivande-statistik.html#import-av-data-från-en-excelfil"><i class="fa fa-check"></i><b>2.2</b> Import av data från en Excelfil</a></li>
<li class="chapter" data-level="2.3" data-path="beskrivande-statistik.html"><a href="beskrivande-statistik.html#ändra-och-skapa-nya-kolumner-med-mutate"><i class="fa fa-check"></i><b>2.3</b> Ändra och skapa nya kolumner med <code>mutate</code></a></li>
<li class="chapter" data-level="2.4" data-path="beskrivande-statistik.html"><a href="beskrivande-statistik.html#sammanfattande-lägesmått"><i class="fa fa-check"></i><b>2.4</b> Sammanfattande lägesmått</a></li>
<li class="chapter" data-level="2.5" data-path="beskrivande-statistik.html"><a href="beskrivande-statistik.html#sammanfattande-spridningsmått"><i class="fa fa-check"></i><b>2.5</b> Sammanfattande spridningsmått</a></li>
<li class="chapter" data-level="2.6" data-path="beskrivande-statistik.html"><a href="beskrivande-statistik.html#ordna-upp-beskrivande-statistik-och-exportera"><i class="fa fa-check"></i><b>2.6</b> Ordna upp beskrivande statistik och exportera</a></li>
<li class="chapter" data-level="2.7" data-path="beskrivande-statistik.html"><a href="beskrivande-statistik.html#kumulativt-medelvärde"><i class="fa fa-check"></i><b>2.7</b> Kumulativt medelvärde</a></li>
<li class="chapter" data-level="2.8" data-path="beskrivande-statistik.html"><a href="beskrivande-statistik.html#tredimensionella-grafer-med-plotly"><i class="fa fa-check"></i><b>2.8</b> Tredimensionella grafer med <code>plotly</code></a></li>
<li class="chapter" data-level="2.9" data-path="beskrivande-statistik.html"><a href="beskrivande-statistik.html#ai-uppgift-ii"><i class="fa fa-check"></i><b>2.9</b> AI-uppgift II</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="ett-stickprov-av-normalfördelad-data.html"><a href="ett-stickprov-av-normalfördelad-data.html"><i class="fa fa-check"></i><b>3</b> Ett stickprov av normalfördelad data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="ett-stickprov-av-normalfördelad-data.html"><a href="ett-stickprov-av-normalfördelad-data.html#repetition-från-datorövning-2"><i class="fa fa-check"></i><b>3.1</b> Repetition från datorövning 2</a></li>
<li class="chapter" data-level="3.2" data-path="ett-stickprov-av-normalfördelad-data.html"><a href="ett-stickprov-av-normalfördelad-data.html#test-av-medelvärde-för-normalfördelad-data"><i class="fa fa-check"></i><b>3.2</b> Test av medelvärde för normalfördelad data</a></li>
<li class="chapter" data-level="3.3" data-path="ett-stickprov-av-normalfördelad-data.html"><a href="ett-stickprov-av-normalfördelad-data.html#konfidensintervall-för-normalfördelad-data"><i class="fa fa-check"></i><b>3.3</b> Konfidensintervall för normalfördelad data</a></li>
<li class="chapter" data-level="3.4" data-path="ett-stickprov-av-normalfördelad-data.html"><a href="ett-stickprov-av-normalfördelad-data.html#normalfördelad-data"><i class="fa fa-check"></i><b>3.4</b> Normalfördelad data</a></li>
<li class="chapter" data-level="3.5" data-path="ett-stickprov-av-normalfördelad-data.html"><a href="ett-stickprov-av-normalfördelad-data.html#centrala-gränsvärdesatsen"><i class="fa fa-check"></i><b>3.5</b> Centrala gränsvärdesatsen</a></li>
<li class="chapter" data-level="3.6" data-path="ett-stickprov-av-normalfördelad-data.html"><a href="ett-stickprov-av-normalfördelad-data.html#ai-uppgift-iii"><i class="fa fa-check"></i><b>3.6</b> AI-uppgift III</a></li>
<li class="chapter" data-level="3.7" data-path="ett-stickprov-av-normalfördelad-data.html"><a href="ett-stickprov-av-normalfördelad-data.html#bonus.-simuleringar-för-t-test"><i class="fa fa-check"></i><b>3.7</b> Bonus. Simuleringar för t-test</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="ett-stickprov-av-icke-normalfördelad-data.html"><a href="ett-stickprov-av-icke-normalfördelad-data.html"><i class="fa fa-check"></i><b>4</b> Ett stickprov av icke-normalfördelad data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="ett-stickprov-av-icke-normalfördelad-data.html"><a href="ett-stickprov-av-icke-normalfördelad-data.html#repetition-av-datorövning-3"><i class="fa fa-check"></i><b>4.1</b> Repetition av datorövning 3</a></li>
<li class="chapter" data-level="4.2" data-path="ett-stickprov-av-icke-normalfördelad-data.html"><a href="ett-stickprov-av-icke-normalfördelad-data.html#proportioner-från-binär-data"><i class="fa fa-check"></i><b>4.2</b> Proportioner från binär data</a></li>
<li class="chapter" data-level="4.3" data-path="ett-stickprov-av-icke-normalfördelad-data.html"><a href="ett-stickprov-av-icke-normalfördelad-data.html#konfidensintervall-för-proportioner"><i class="fa fa-check"></i><b>4.3</b> Konfidensintervall för proportioner</a></li>
<li class="chapter" data-level="4.4" data-path="ett-stickprov-av-icke-normalfördelad-data.html"><a href="ett-stickprov-av-icke-normalfördelad-data.html#chi-två-test-för-goodness-of-fit"><i class="fa fa-check"></i><b>4.4</b> Chi-två-test för goodness-of-fit</a></li>
<li class="chapter" data-level="4.5" data-path="ett-stickprov-av-icke-normalfördelad-data.html"><a href="ett-stickprov-av-icke-normalfördelad-data.html#bonus.-interaktiva-kartor-med-leaflet"><i class="fa fa-check"></i><b>4.5</b> Bonus. Interaktiva kartor med leaflet</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="test-för-två-stickprov.html"><a href="test-för-två-stickprov.html"><i class="fa fa-check"></i><b>5</b> Test för två stickprov</a>
<ul>
<li class="chapter" data-level="5.1" data-path="test-för-två-stickprov.html"><a href="test-för-två-stickprov.html#repetition-av-datorövning-4"><i class="fa fa-check"></i><b>5.1</b> Repetition av datorövning 4</a></li>
<li class="chapter" data-level="5.2" data-path="test-för-två-stickprov.html"><a href="test-för-två-stickprov.html#två-stickprov-och-normalfördelad-data"><i class="fa fa-check"></i><b>5.2</b> Två stickprov och normalfördelad data</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="test-för-två-stickprov.html"><a href="test-för-två-stickprov.html#t-test-för-två-matchade-stickprov"><i class="fa fa-check"></i><b>5.2.1</b> t-test för två matchade stickprov</a></li>
<li class="chapter" data-level="5.2.2" data-path="test-för-två-stickprov.html"><a href="test-för-två-stickprov.html#t-test-för-två-oberoende-stickprov"><i class="fa fa-check"></i><b>5.2.2</b> t-test för två oberoende stickprov</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="test-för-två-stickprov.html"><a href="test-för-två-stickprov.html#z-test-och-konfidensintervall-för-två-proportioner"><i class="fa fa-check"></i><b>5.3</b> z-test och konfidensintervall för två proportioner</a></li>
<li class="chapter" data-level="5.4" data-path="test-för-två-stickprov.html"><a href="test-för-två-stickprov.html#chi-två-test-för-korstabeller"><i class="fa fa-check"></i><b>5.4</b> Chi-två-test för korstabeller</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="variansanalys.html"><a href="variansanalys.html"><i class="fa fa-check"></i><b>6</b> Variansanalys</a>
<ul>
<li class="chapter" data-level="6.1" data-path="variansanalys.html"><a href="variansanalys.html#repetition-av-datorövning-5"><i class="fa fa-check"></i><b>6.1</b> Repetition av datorövning 5</a></li>
<li class="chapter" data-level="6.2" data-path="variansanalys.html"><a href="variansanalys.html#allmänt"><i class="fa fa-check"></i><b>6.2</b> Allmänt</a></li>
<li class="chapter" data-level="6.3" data-path="variansanalys.html"><a href="variansanalys.html#variansanalys.-en-faktor"><i class="fa fa-check"></i><b>6.3</b> Variansanalys. En faktor</a></li>
<li class="chapter" data-level="6.4" data-path="variansanalys.html"><a href="variansanalys.html#variansanalys.-en-faktor-med-block"><i class="fa fa-check"></i><b>6.4</b> Variansanalys. En faktor med block</a></li>
<li class="chapter" data-level="6.5" data-path="variansanalys.html"><a href="variansanalys.html#bonus.-två-faktorer-med-block"><i class="fa fa-check"></i><b>6.5</b> Bonus. Två faktorer med block</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="regression-och-korrelation.html"><a href="regression-och-korrelation.html"><i class="fa fa-check"></i><b>7</b> Regression och korrelation</a>
<ul>
<li class="chapter" data-level="7.1" data-path="regression-och-korrelation.html"><a href="regression-och-korrelation.html#repetition-av-datorövning-6"><i class="fa fa-check"></i><b>7.1</b> Repetition av datorövning 6</a></li>
<li class="chapter" data-level="7.2" data-path="regression-och-korrelation.html"><a href="regression-och-korrelation.html#regression"><i class="fa fa-check"></i><b>7.2</b> Regression</a></li>
<li class="chapter" data-level="7.3" data-path="regression-och-korrelation.html"><a href="regression-och-korrelation.html#korrelation"><i class="fa fa-check"></i><b>7.3</b> Korrelation</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R-anvisningar till <em>Grundläggande statistik</em></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="test-för-två-stickprov" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">5</span> Test för två stickprov<a href="test-för-två-stickprov.html#test-för-två-stickprov" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Datorövning 5 handlar om hypotestest och konfidensintervall för jämförelse av två stickprov. Efter övningen ska vi kunna genomföra och tolka</p>
<ul>
<li><p>t-test för jämförelse av två medelvärden,</p></li>
<li><p>z-test för jämförelse av två proportioner,</p></li>
<li><p>chi-två-test för jämförelse av fördelningar mellan två eller flera grupper,</p></li>
<li><p>konfidensintervall för skillnaden mellan två medelvärden eller två proportioner.</p></li>
</ul>
<div id="repetition-av-datorövning-4" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Repetition av datorövning 4<a href="test-för-två-stickprov.html#repetition-av-datorövning-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>När man startar en ny R-session bör man ladda de paket man vet kommer behövas med <code>library()</code>. Om paket inte finns installerade måste man först köra <code>install.packages()</code>.</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="test-för-två-stickprov.html#cb172-1" tabindex="-1"></a><span class="co"># install.packages(&quot;tidyverse&quot;)</span></span>
<span id="cb172-2"><a href="test-för-två-stickprov.html#cb172-2" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<p>I datorövning 4 tittade vi på tester som inte bygger på normalfördelning: dels tester för proportioner, där varje observation är något av två möjliga utfall; dels tester för kategoridata, där varje observation har ett ufall i någon av flera kategorier.</p>
<p>Proportioner kan testas med ett z-test. Säg att man testar om en doft har en effekt på en insekt, man skickar 20 insekter i ett y-rör och 16 går mot doften. Hypoteserna ges av</p>
<ul>
<li><span class="math inline">\(H_0\)</span>: proportionen i populationen är 0.5,</li>
<li><span class="math inline">\(H_1\)</span>: proportionen i populationen är inte 0.5.</li>
</ul>
<p>I R genomförs ett z-test med <code>prop.test()</code>. Funktionen gör en korrektion som ger ett något bättre test än det man ofta beräknar för hand. Korrektionen kan sättas av med argumentet <code>correct</code>.</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="test-för-två-stickprov.html#cb173-1" tabindex="-1"></a><span class="fu">prop.test</span>(<span class="at">x =</span> <span class="dv">16</span>, <span class="at">n =</span> <span class="dv">20</span>, <span class="at">p =</span> <span class="fl">0.5</span>, <span class="at">correct =</span> F)</span></code></pre></div>
<p>Ett lågt p-värde tyder på en signifikant skillnad från 0.5.</p>
<p>För att få samma konfidensintervall som det man beräknar för hand kan man använda <code>binom.asymp()</code> från paketet <code>binom</code>.</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="test-för-två-stickprov.html#cb174-1" tabindex="-1"></a><span class="fu">library</span>(binom)</span>
<span id="cb174-2"><a href="test-för-två-stickprov.html#cb174-2" tabindex="-1"></a><span class="fu">binom.asymp</span>(<span class="dv">16</span>, <span class="dv">20</span>)</span></code></pre></div>
<p>Populationens proportion ligger med 95 procents konfidens mellan 0.62 och 0.98.</p>
<p>Om utfallen är mer än två kategorier kan en hypotes om datans fördelning testas med ett goodness-of-fit-test, vilket är ett slags chi-två-test. Testet bygger på att observerade antal (O) ställs mot förväntade antal (E). I R genomförs ett chi-två-test med <code>chisq.test()</code>. Säg som exempel att man studerar fågelpopulationer genom en observationsstudie. Observerade antal av fyra fågelarter är 102, 53, 75 och 12 och de förväntade andelarna av arterna är 50, 15, 25 och 10 procent. Testets hypoteser ges av</p>
<ul>
<li><span class="math inline">\(H_0\)</span>: proportionerna följer den förväntade fördelningen,</li>
<li><span class="math inline">\(H_1\)</span>: proportionerna följer inte den förväntade fördelningen,</li>
</ul>
<p>och testet ges av</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="test-för-två-stickprov.html#cb175-1" tabindex="-1"></a><span class="fu">chisq.test</span>(<span class="fu">c</span>(<span class="dv">102</span>, <span class="dv">53</span>, <span class="dv">75</span>, <span class="dv">12</span>), <span class="at">p =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.15</span>, <span class="fl">0.25</span>, <span class="fl">0.10</span>))</span></code></pre></div>
<p>Ett lågt p-värde tyder på att de antagna proportionerna inte stämmer. Antalet frihetsgrader ges i ett chi-två-test av antalet klasser minus antalet skattade parametrar minus ett. I det här fallet finns fyra klasser och ingen skattad parameter.</p>
</div>
<div id="två-stickprov-och-normalfördelad-data" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Två stickprov och normalfördelad data<a href="test-för-två-stickprov.html#två-stickprov-och-normalfördelad-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Vid normalfördelad data från två stickprov eller grupper vill vi nästan alltid testa om populationerna har samma medelvärde. Det kan också ses som att vi testar om differensen mellan medelvärdena är noll. Vi skiljer mellan två fall: <em>matchade stickprov</em> - där varje observation i den ena gruppen är <em>kopplad</em> till en observation i den andra gruppen; och <em>oberoende stickprov</em> - där det inte finns någon sådan koppling mellan stickproven. Typiska exempel på matchade stickprov är när man mäter samma individ för och efter en behandling och syskonstudier där ett syskon får en behandling och den andra en annan behandling.</p>
<div id="t-test-för-två-matchade-stickprov" class="section level3 hasAnchor" number="5.2.1">
<h3><span class="header-section-number">5.2.1</span> t-test för två matchade stickprov<a href="test-för-två-stickprov.html#t-test-för-två-matchade-stickprov" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Vid matchade stickprov kan varje observation i en behandlingsgrupp paras med en observation i den andra gruppen. Själva testet är ett t-test för <em>ett</em> stickprov på differensserien beräknat från varje par. I R kan man antingen beräkna den differensserien eller använda <code>t.test()</code> med två dataserier och argumentet för parvisa observationer satt till sant, <code>paired = T</code>.
Som exempel ges följande data från en studie på äpple, där trädhöjd mätts före och efter en näringsbehandling.</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="test-för-två-stickprov.html#cb176-1" tabindex="-1"></a>dat_apple <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">Tree =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, </span>
<span id="cb176-2"><a href="test-för-två-stickprov.html#cb176-2" tabindex="-1"></a>              <span class="at">Before =</span> <span class="fu">c</span>(<span class="dv">48</span>, <span class="dv">43</span>, <span class="dv">30</span>, <span class="dv">47</span>), </span>
<span id="cb176-3"><a href="test-för-två-stickprov.html#cb176-3" tabindex="-1"></a>              <span class="at">After =</span> <span class="fu">c</span>(<span class="dv">51</span>, <span class="dv">44</span>, <span class="dv">42</span>, <span class="dv">54</span>))</span>
<span id="cb176-4"><a href="test-för-två-stickprov.html#cb176-4" tabindex="-1"></a>dat_apple</span></code></pre></div>
<p>Datan kan illustreras med ett punktdiagram där en linje binder samman paret. För att enkelt skapa grafen i <code>ggplot2</code> kan man först omstrukturera datan till lång form genom <code>pivot_longer</code>.</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="test-för-två-stickprov.html#cb177-1" tabindex="-1"></a>dat_long <span class="ot">&lt;-</span> dat_apple <span class="sc">%&gt;%</span> </span>
<span id="cb177-2"><a href="test-för-två-stickprov.html#cb177-2" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>Tree, <span class="at">names_to =</span> <span class="st">&quot;Time&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;Height&quot;</span>)</span>
<span id="cb177-3"><a href="test-för-två-stickprov.html#cb177-3" tabindex="-1"></a>dat_long</span></code></pre></div>
<div class="exercise">
<p><span id="exr:unlabeled-div-67" class="exercise"><strong>Uppgift 5.1  (Äppelgraf) </strong></span>Fyll i kodstycket nedan för en graf av äppeldatan. Axlarna ges av <code>Time</code> och <code>Height</code>. Två observationer kan kopplas genom att sätta <code>Tree</code> som grupp.</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="test-för-två-stickprov.html#cb178-1" tabindex="-1"></a><span class="fu">ggplot</span>(dat_long, <span class="fu">aes</span>(___, ___, <span class="at">group =</span> ___)) <span class="sc">+</span></span>
<span id="cb178-2"><a href="test-för-två-stickprov.html#cb178-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb178-3"><a href="test-för-två-stickprov.html#cb178-3" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code></pre></div>
</div>
<p>För att testa för skillnad före och efter behandling sätter vi upp hypoteser</p>
<ul>
<li><span class="math inline">\(H_0\)</span>: <span class="math inline">\(\mu\)</span> före behandling är lika med <span class="math inline">\(\mu\)</span> efter behandling</li>
<li><span class="math inline">\(H_1\)</span>: <span class="math inline">\(\mu\)</span> före behandling är skild från <span class="math inline">\(\mu\)</span> efter behandling</li>
</ul>
<p>Testet kan antingen utföras som ett enkelt t-test på differensserien</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="test-för-två-stickprov.html#cb179-1" tabindex="-1"></a><span class="fu">t.test</span>(dat_apple<span class="sc">$</span>Before <span class="sc">-</span> dat_apple<span class="sc">$</span>After)</span></code></pre></div>
<p>eller som ett t-test för två stickprov där man särskilt anger att datan är parad</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="test-för-två-stickprov.html#cb180-1" tabindex="-1"></a><span class="fu">t.test</span>(dat_apple<span class="sc">$</span>Before, dat_apple<span class="sc">$</span>After, <span class="at">paired =</span> T)</span></code></pre></div>
<p>För bägge alternativen måste datan vara ordnad så att de två vektorerna matchar varandra parvis. Ett p-värde på <span class="math inline">\(0.0987\)</span> ger att man inte förkastar vid en signifikansnivå på fem procent. Vi drar därmed slutsatsen att det inte finns någon signifikant skillnad före och efter behandling.</p>
<div class="exercise">
<p><span id="exr:unlabeled-div-68" class="exercise"><strong>Uppgift 5.2  (Ensidigt test) </strong></span>Gör ett tillägg till ett av kodstyckena med <code>t.test()</code> för att beräkna ett ensidigt test med mothypotesen att träden ökar i höjd efter behandling. Hjälpsidan för <code>t.test()</code> kan tas fram genom att köra <code>?t.test()</code>.</p>
</div>
<p>Konfidensintervallet beräknas från differenserna på samma sätt som vid ett stickprov med normalfördelad data. Tolkningen liknar den för ett stickprov: med 95 procents konfidens ligger den sanna skillnaden i medelvärden i intervallet.</p>
</div>
<div id="t-test-för-två-oberoende-stickprov" class="section level3 hasAnchor" number="5.2.2">
<h3><span class="header-section-number">5.2.2</span> t-test för två oberoende stickprov<a href="test-för-två-stickprov.html#t-test-för-två-oberoende-stickprov" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Ett t-test för två oberoende stickprov testar om två populationsmedelvärden är lika. Ta som exempel följande data på jordgubbsskörd vid två olika näringsbehandlingar (A och B). Här är stickproven inte matchade - det finns <strong>ingen</strong> direkt koppling mellan en observation i den ena behandlingsgruppen till någon observation i den andra.</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="test-för-två-stickprov.html#cb181-1" tabindex="-1"></a>dat_berry <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Behandling =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;A&quot;</span>, <span class="st">&quot;A&quot;</span>, <span class="st">&quot;A&quot;</span>, </span>
<span id="cb181-2"><a href="test-för-två-stickprov.html#cb181-2" tabindex="-1"></a>                                       <span class="st">&quot;B&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;B&quot;</span>),</span>
<span id="cb181-3"><a href="test-för-två-stickprov.html#cb181-3" tabindex="-1"></a>                        <span class="at">Vikt =</span> <span class="fu">c</span>(<span class="dv">40</span>, <span class="fl">48.2</span>, <span class="fl">39.2</span>, <span class="fl">47.9</span>, </span>
<span id="cb181-4"><a href="test-för-två-stickprov.html#cb181-4" tabindex="-1"></a>                                 <span class="fl">57.5</span>, <span class="fl">61.5</span>, <span class="dv">58</span>, <span class="fl">66.5</span>))</span>
<span id="cb181-5"><a href="test-för-två-stickprov.html#cb181-5" tabindex="-1"></a>dat_berry</span></code></pre></div>
<p>Datan kan illustreras med ett enkelt punktdiagram.</p>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="test-för-två-stickprov.html#cb182-1" tabindex="-1"></a><span class="fu">ggplot</span>(dat_berry, <span class="fu">aes</span>(Behandling, Vikt)) <span class="sc">+</span></span>
<span id="cb182-2"><a href="test-för-två-stickprov.html#cb182-2" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p>Ett t-test för två oberoende stickprov har nollhypotesen att grupperna har samma populationsmedelvärde och alternativhypotesen att populationsmedelvärdena är skilda (för det tvåsidiga fallet):</p>
<ul>
<li><span class="math inline">\(H_0\)</span>: <span class="math inline">\(\mu_A\)</span> är lika med <span class="math inline">\(\mu_B\)</span></li>
<li><span class="math inline">\(H_1\)</span>: <span class="math inline">\(\mu_A\)</span> är ej lika med <span class="math inline">\(\mu_B\)</span></li>
</ul>
<p>Testet kan utföras i R genom funktionen <code>t.test()</code>. Data kan antingen anges som en formel med dess data <code>Vikt ~ Behandling, data = dat_berry</code> (vilket man kan läsa som <em>vikt uppdelat efter behandling</em>) eller som två skilda vektorer. Det förra alternativet är oftast enklare om man har datan på lång form - med en kolumn som anger grupp (i exemplet <em>Behandling</em>) och en kolumn som anger utfallsvärdet (i exemplet <em>Vikt</em>).</p>
<p>För formen med formel ger det</p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="test-för-två-stickprov.html#cb183-1" tabindex="-1"></a><span class="co"># Formelskrivning</span></span>
<span id="cb183-2"><a href="test-för-två-stickprov.html#cb183-2" tabindex="-1"></a><span class="fu">t.test</span>(Vikt <span class="sc">~</span> Behandling, <span class="at">data =</span> dat_berry, <span class="at">var.equal =</span> T)</span></code></pre></div>
<p>och för formen med vektorer</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="test-för-två-stickprov.html#cb184-1" tabindex="-1"></a><span class="co"># Två separata vektorer</span></span>
<span id="cb184-2"><a href="test-för-två-stickprov.html#cb184-2" tabindex="-1"></a><span class="do">## Filtrera ut data där behandling är A</span></span>
<span id="cb184-3"><a href="test-för-två-stickprov.html#cb184-3" tabindex="-1"></a>Vikt_A <span class="ot">&lt;-</span> dat_berry<span class="sc">$</span>Vikt[dat_berry<span class="sc">$</span>Behandling <span class="sc">==</span> <span class="st">&quot;A&quot;</span>]</span>
<span id="cb184-4"><a href="test-för-två-stickprov.html#cb184-4" tabindex="-1"></a></span>
<span id="cb184-5"><a href="test-för-två-stickprov.html#cb184-5" tabindex="-1"></a><span class="do">## Filtrera ut data där behandling är B</span></span>
<span id="cb184-6"><a href="test-för-två-stickprov.html#cb184-6" tabindex="-1"></a>Vikt_B <span class="ot">&lt;-</span> dat_berry<span class="sc">$</span>Vikt[dat_berry<span class="sc">$</span>Behandling <span class="sc">==</span> <span class="st">&quot;B&quot;</span>]</span>
<span id="cb184-7"><a href="test-för-två-stickprov.html#cb184-7" tabindex="-1"></a></span>
<span id="cb184-8"><a href="test-för-två-stickprov.html#cb184-8" tabindex="-1"></a><span class="fu">t.test</span>(Vikt_A, Vikt_B, <span class="at">var.equal =</span> T)</span></code></pre></div>
<p>Argumentet <code>var.equal = T</code> används för att beräkna testet där gruppernas varianser antas vara lika. Grundinställningen är testet där varianser inte antas vara lika, så <code>t.test(Vikt ~ Behandling, data = dat)</code> ger ett lite annat resultat.</p>
<div class="exercise">
<p><span id="exr:unlabeled-div-69" class="exercise"><strong>Uppgift 5.3  (Ej lika varianser) </strong></span>Vilka resultatvärden ändras i utskriften om man sätter <code>var.equal = F</code>?</p>
</div>
<p>Testet ger ett p-värde på <span class="math inline">\(0.0018\)</span>, vilket leder till att nollhypotesen förkastas på enprocentsnivån. Detta tyder på att det finns en viktskillnad mellan behandlingarna. Utskriften ger också ett 95-procentigt konfidensintervall på <span class="math inline">\((-24.898, -9.202)\)</span>. Tolkningen är att <em>skillnaden</em> mellan populationsmedelvärden ligger i intervallet med 95 procents konfidens. Notera att värdet noll inte ligger i intervallet.</p>
<p>Om man har fler än två grupper kan man vilja göra parvisa t-test - alltså ett t-test för varje par av grupper.
Ett exempel på funktionen <code>pairwise.t.test()</code> ges nedan. Funktionen bygger på att datan är i <em>lång</em> form, med en kolumn som anger det numeriska utfallet och en kolumn som anger behandlingen.</p>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="test-för-två-stickprov.html#cb185-1" tabindex="-1"></a><span class="fu">pairwise.t.test</span>(dat_berry<span class="sc">$</span>Vikt, dat_berry<span class="sc">$</span>Behandling, </span>
<span id="cb185-2"><a href="test-för-två-stickprov.html#cb185-2" tabindex="-1"></a>                <span class="at">p.adjust.method =</span> <span class="st">&quot;none&quot;</span>, <span class="at">pool.sd =</span> F)</span></code></pre></div>
<pre><code>## 
##  Pairwise comparisons using t tests with non-pooled SD 
## 
## data:  dat_berry$Vikt and dat_berry$Behandling 
## 
##   A    
## B 0.002
## 
## P value adjustment method: none</code></pre>
<p><em>Matchade</em> observationer kan också kallas <em>parade</em> (eng. paired) så se upp med terminologin. Funktionen <code>pairwise.t.test()</code> för <em>parvisa jämförelse</em> mellan behandlingar, men testerna är t-test för oberoende stickprov.</p>
</div>
</div>
<div id="z-test-och-konfidensintervall-för-två-proportioner" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> z-test och konfidensintervall för två proportioner<a href="test-för-två-stickprov.html#z-test-och-konfidensintervall-för-två-proportioner" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Om man vill jämföra två proportioner kan man använda z-testet för två stickprov. Säg till exempel att man har två sorter av någon planta och vill se hur stor proportion som är infekterad av bladmögel. I den ena gruppen (sort A) är 17 av 50 infektera och i den andra (sort B) är 26 av 60 infekterade. Testets hypoteser är i det tvåsidiga fallet</p>
<ul>
<li><span class="math inline">\(H_0\)</span>: proportion A är lika med proportion B</li>
<li><span class="math inline">\(H_1\)</span>: proportion A är skild från proportion B</li>
</ul>
<p>I R kan testet genomföras med <code>prop.test()</code>-funktionen. Funktionens första argument är antalen infekterade, som en vektor med två värden, och dess andra argument är totalerna. Likt testet med ett stickprov finns en möjlighet att göra en kontinuitetskorrektion med <code>correct</code>-argumentet. För att få samma resultat som räkning för hand anger vi att korrektion inte ska göras med <code>correct = F</code>.</p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="test-för-två-stickprov.html#cb187-1" tabindex="-1"></a><span class="fu">prop.test</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">17</span>, <span class="dv">26</span>), <span class="at">n =</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">60</span>), <span class="at">correct =</span> F)</span></code></pre></div>
<p>Notera att funktionen inte ger ett z-värde utan ett <span class="math inline">\(\chi^2\)</span>-värde (utskrivet <code>X-squared</code>). Det beror på att funktionen beräknar z-testet som ett likvärdigt <span class="math inline">\(\chi^2\)</span>-test. Det z-värde man får om man genomför testet som ett z-test är detsamma som roten ur utskriftens <span class="math inline">\(\chi^2\)</span>-värde. Testet ger ett högt p-värde på 0.32 vilket innebär att nollhypotesen inte förkastas: det finns ingen signifikant skillnad i infektionsproportion.</p>
<p>Funktionen <code>prop.test()</code> ger också en utskrift av konfidensintervallet. Tolkning är att skillnaden i proportioner mellan populationerna ligger i intervallet med 95 procents konfidens. Notera att nollan ingår i intervallet.</p>
<div class="exercise">
<p><span id="exr:unlabeled-div-70" class="exercise"><strong>Uppgift 5.4  (Burfågel) </strong></span>Det finns en förvånansvärt stor mängd studier på kopplingen mellan innehav av burfågel och lungcancer. En sådan studie (Kohlmeier et al 1992) ger följande antal för burfågelägande och lungcancer.</p>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="test-för-två-stickprov.html#cb188-1" tabindex="-1"></a>dat_bird <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Burfågel <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Burfågel&quot;</span>, <span class="st">&quot;Ej_burfågel&quot;</span>),</span>
<span id="cb188-2"><a href="test-för-två-stickprov.html#cb188-2" tabindex="-1"></a>              <span class="at">Lungcancer =</span> <span class="fu">c</span>(<span class="dv">98</span>, <span class="dv">141</span>),</span>
<span id="cb188-3"><a href="test-för-två-stickprov.html#cb188-3" tabindex="-1"></a>              <span class="at">Ej_lungcancer =</span> <span class="fu">c</span>(<span class="dv">101</span>, <span class="dv">328</span>))</span>
<span id="cb188-4"><a href="test-för-två-stickprov.html#cb188-4" tabindex="-1"></a>dat_bird</span></code></pre></div>
<p>Datan tyder på att människor med burfågel har en förhöjd risk att drabbas av lungcancer. Genomför ett z-test för att se om andelen burfågelägare än densamma i de två patientgrupperna.</p>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="test-för-två-stickprov.html#cb189-1" tabindex="-1"></a><span class="fu">prop.test</span>(<span class="at">x =</span> <span class="fu">c</span>(___, ___), <span class="at">n =</span> <span class="fu">c</span>(___, ___), <span class="at">correct =</span> F)</span></code></pre></div>
</div>
</div>
<div id="chi-två-test-för-korstabeller" class="section level2 hasAnchor" number="5.4">
<h2><span class="header-section-number">5.4</span> Chi-två-test för korstabeller<a href="test-för-två-stickprov.html#chi-två-test-för-korstabeller" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Data med två kategoriska variabler kan presenteras med en korstabell. Ta som (ett något deppigt) exempel överlevnadsdata från Titanic. Datan finns tillgänglig i R som <code>Titanic</code>. I detta fall ges överlevnad filtrerad på vuxna män, uppdelat efter klass.</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="test-för-två-stickprov.html#cb190-1" tabindex="-1"></a>dat_titanic <span class="ot">&lt;-</span> Titanic <span class="sc">%&gt;%</span> </span>
<span id="cb190-2"><a href="test-för-två-stickprov.html#cb190-2" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb190-3"><a href="test-för-två-stickprov.html#cb190-3" tabindex="-1"></a>  <span class="fu">filter</span>(Sex <span class="sc">==</span> <span class="st">&quot;Male&quot;</span>, Age <span class="sc">==</span> <span class="st">&quot;Adult&quot;</span>)</span>
<span id="cb190-4"><a href="test-för-två-stickprov.html#cb190-4" tabindex="-1"></a>dat_titanic</span></code></pre></div>
<p>En korstabell kan konstrueras med <code>pivot_wider</code>.</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="test-för-två-stickprov.html#cb191-1" tabindex="-1"></a>dat_wide <span class="ot">&lt;-</span> dat_titanic <span class="sc">%&gt;%</span> </span>
<span id="cb191-2"><a href="test-för-två-stickprov.html#cb191-2" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> Survived, <span class="at">values_from =</span> Freq)</span>
<span id="cb191-3"><a href="test-för-två-stickprov.html#cb191-3" tabindex="-1"></a>dat_wide</span></code></pre></div>
<p>Datan tyder på att överlevnad är beroende av klass. Vi kan illustrera med uppdelade staplar.</p>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="test-för-två-stickprov.html#cb192-1" tabindex="-1"></a><span class="fu">ggplot</span>(dat_titanic, <span class="fu">aes</span>(Class, Freq, <span class="at">fill =</span> Survived)) <span class="sc">+</span></span>
<span id="cb192-2"><a href="test-för-två-stickprov.html#cb192-2" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="fu">position_fill</span>(), <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb192-3"><a href="test-för-två-stickprov.html#cb192-3" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;red4&quot;</span>, <span class="st">&quot;white&quot;</span>))</span></code></pre></div>
<p>Argumentet <code>position</code> i <code>geom_bar</code> används för att skapa proportionella staplar.</p>
<p>Ett chi-två-test på en korstabell har nollhypotesen att det inte finns något samband mellan variabeln för rader och variabeln för kolumner. Chi-två-testet kan tillämpas på korstabeller med godtyckligt antal rader och kolumner. Antal frihetsgrader ges av antal rader minus ett gånger antal kolumner minus ett. Testet kan enkelt göras med <code>chisq.test()</code>. Som ingångsvärde kan man plocka ut kolumnerna med numeriska värden genom hakparenteser.</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="test-för-två-stickprov.html#cb193-1" tabindex="-1"></a>dat_wide[, <span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>] <span class="co"># De två numeriska kolumnerna</span></span>
<span id="cb193-2"><a href="test-för-två-stickprov.html#cb193-2" tabindex="-1"></a></span>
<span id="cb193-3"><a href="test-för-två-stickprov.html#cb193-3" tabindex="-1"></a><span class="fu">chisq.test</span>(dat_wide[, <span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>])</span></code></pre></div>
<p>Utskriften ger teststorheten, antal frihetsgrader, och p-värdet. I det här fallet är p-värdet mycket litet och slutsatsen blir att nollhypotesen förkastas - det finns ett samband mellan klass och överlevnad. Antalet frihetsgrader ges av antalet rader minus ett gånger antalet kolumner minus ett (här <span class="math inline">\((4-1) \cdot (2-1) = 3\)</span>).</p>
<p>Chi-två-testet är ett asymptotiskt test - dess egenskaper är beroende av <em>stora</em> stickprov. Som gräns för storleken används ofta att samtliga förväntade antal ska vara större än 5. Funktionen ger en varning om förväntade värden är små. En möjlig lösning i sådana fall är att slå ihop klasser.</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="test-för-två-stickprov.html#cb194-1" tabindex="-1"></a>test_result <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(dat_wide[, <span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>])</span>
<span id="cb194-2"><a href="test-för-två-stickprov.html#cb194-2" tabindex="-1"></a>test_result<span class="sc">$</span>expected <span class="co"># Samtliga förväntade värden över 5</span></span></code></pre></div>
<p>Om detta krav inte är uppfyllt skriver funktionen ut en varning.</p>
<div class="exercise">
<p><span id="exr:unlabeled-div-71" class="exercise"><strong>Uppgift 5.5  (Ogiltig approximation) </strong></span>Ta följande lilla korstabell och kör <code>chisq.test()</code> för att få ett felmeddelande.</p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="test-för-två-stickprov.html#cb195-1" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">1</span>), <span class="dv">2</span>)</span>
<span id="cb195-2"><a href="test-för-två-stickprov.html#cb195-2" tabindex="-1"></a>dat</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    4    5
## [2,]    2    1</code></pre>
</div>
<div class="exercise">
<p><span id="exr:unlabeled-div-72" class="exercise"><strong>Uppgift 5.6  (Burfågeln återvänder) </strong></span>En svensk studie på koppling mellan burfågel och lungcancer (Modigh et al, 1996) ger följande antal (för män).</p>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="test-för-två-stickprov.html#cb197-1" tabindex="-1"></a>dat_bird_swe <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Burfågel <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Burfågel&quot;</span>, <span class="st">&quot;Ej_burfågel&quot;</span>),</span>
<span id="cb197-2"><a href="test-för-två-stickprov.html#cb197-2" tabindex="-1"></a>              <span class="at">Lungcancer =</span> <span class="fu">c</span>(<span class="dv">108</span>, <span class="dv">144</span>),</span>
<span id="cb197-3"><a href="test-för-två-stickprov.html#cb197-3" tabindex="-1"></a>              <span class="at">Ej_lungcancer =</span> <span class="fu">c</span>(<span class="dv">171</span>, <span class="dv">256</span>))</span>
<span id="cb197-4"><a href="test-för-två-stickprov.html#cb197-4" tabindex="-1"></a>dat_bird_swe</span></code></pre></div>
<p>Genomför ett chi-två-test för att se om andelen cancerdrabbade än densamma i de två burfågelsgrupperna. Formulera tydliga hypoteser. För att få utfall som stämmer med en handräkning kan man sätta <code>correct = F</code>.</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="test-för-två-stickprov.html#cb198-1" tabindex="-1"></a>dat_bird_swe[, <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>)]</span>
<span id="cb198-2"><a href="test-för-två-stickprov.html#cb198-2" tabindex="-1"></a><span class="fu">chisq.test</span>(___, <span class="at">correct =</span> F)</span></code></pre></div>
</div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="ett-stickprov-av-icke-normalfördelad-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="variansanalys.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "serif",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["R-anvisningar.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
